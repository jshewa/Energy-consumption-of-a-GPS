\begin{appendices}
\chapter{C027.cpp}
\begin{lstlisting}
#include "mbed.h"
#include "C027.h"
#include "rtos.h"

int power= 0;
char order= 'O';
int BAUDRATE=9600;
int timer;
int MEASURE_TIME= 1000000000;
C027 devkit;
DigitalOut trigger(D0);

void serialhandler(){
    //devkit.gpsPower(true);
    
    // open the gps serial port
    Serial gps(GPSTXD, GPSRXD);
    gps.baud(BAUDRATE);
    
    // open the PC serial port and (use the same baudrate)
    Serial pc(USBTX, USBRX);
    pc.baud(BAUDRATE);
    //devkit.gpsPower(true);
    while(1){
        if(pc.readable()){
            order = pc.getc();
            if(order=='D' && power){
                devkit.gpsPower(false);
                timer= MEASURE_TIME;
                power = 0;
                }
            else if(order=='E' && !power){
                devkit.gpsPower(true);
                timer= MEASURE_TIME;
                power= 1;
                }
            else if(order=='R'){
                    devkit.gpsReset();
                    timer = 0;
                    }  
        }
    if(gps.readable() && pc.writeable()){
        pc.putc(gps.getc());
        }
    }
}
void measure(){
     while(1){
     trigger.write(1);
     wait_ms(10);
     trigger.write(0); //Trekker utgangen ned
     wait_ms(10);
     timer --;
     while(timer<=0){
         wait_ms(1);
         }
    }
}
int main(){
    devkit.gpsPower(false);
    Thread thread_serial;
    Thread thread_measure;
    
    thread_measure.start(measure);
    thread_serial.start(serialhandler);
   while(1){}
    return 0; }
\end{lstlisting}
\label{Appendix:C027.Cpp}

\end{appendices}